<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimalist Reader</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Courier+Prime&display=swap">
<style>

:root {
    --TextSetWidthFixed: 20px;
    --TextSetWidthDynamic: 10vw;
    --TextSize: 1.5em;
    --TextLineHeight: 1.5em;

    --Title: 2.5em;
    --Subtitle: 2.0em;
    --Section: 2.5em;
}

body {
    overflow:hidden;
}
div {
    border: 1px solid black;
}
.Cody {
    color: navy;
    font-family: 'Bahnschrift', 'Arial';
}
p.Cody {
    font-size: var(--TextSize);
    line-height: var(--TextLineHeight);
    text-align: justify;
}

h3 {
    text-align: center;
}
h3.Title {
    font-size: var(--Title);
    text-decoration: underline;
}
h3.Subtitle {
    font-size: var(--Subtitle);
}
h3.Section {
    font-size: var(--Section);
}

.Katiya {
    color: maroon;
    font-family: 'Lucida Fax', 'Times New Roman'
}
p.Katiya {
    font-size: calc(var(--TextSize) - 0.2em);
    line-height: var(--TextLineHeight);
    text-align: justify;
}

div.FullContainer {
    display: grid;
    grid-template:
        'leftmargin header header header rightmargin'
        'leftmargin body body body rightmargin'
        'leftmargin footer footer footer rightmargin';
    grid-column-gap: 0px;
    grid-row-gap: 0px;

    position:absolute;
    width:100vw;
    height:100dvh;
    left:-50vw;
    top:0;
    transform: translateX(50vw);
    overflow:hidden;
}
@media only screen and (max-width: 800px) {
    div.FullContainer {
        grid-template:
            'header header header'
            'leftmargin body rightmargin'
            'footer footer footer';
    }
}

.ContainerLeft   { 
    grid-area: leftmargin;
}
.ContainerHead   { 
    grid-area: header;
    height:100px;
}
.ContainerRight  { 
    grid-area: rightmargin;
}
.ContainerBody   { 
    grid-area: body;
    height: calc(100dvh - 200px);
    width: min(600px, 90vw);
    overflow-x: hidden;
    overflow-y: scroll;
    scrollbar-width: none;
}
.ContainerFooter { 
    grid-area: footer;
    height:100px;
} 
div.Gutter {
    width: max(calc((100vw - 600px)/2),5vw)
}
div.Page {
    position:relative;
    left: min(var(--TextSetWidthFixed), var(--TextSetWidthDynamic));
    width:max(calc(100% - (var(--TextSetWidthFixed)*2)), calc(100% - (var(--TextSetWidthDynamic)*2)));
    padding-bottom: calc(50dvh - 200px);
}

</style>
</head>

<body>

<div class="FullContainer" id="FULL">
    <div class="ContainerLeft Gutter">Left</div>
    <div class="ContainerHead" onclick="DisplayMode=(DisplayMode=='Light')?'Dark':'Light';console.log('Changed color to '+DisplayMode+'.');SetStyles();runScrollEvents();">Head</div>
    <div class="ContainerRight Gutter">Right</div>
    <div class="ContainerBody" id="BODY">
        <div class="Page" id="PAGE">
            <p class="Default"></p>
            <h3 class="Cody Title">Chapter One</h3>
            <h3 class="Cody Subtitle">The First One</h3>
            <h3 class="Cody Section">-1-</h3>
            <p class="Cody">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Cody">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Cody">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Cody">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Cody">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <h3 class="Katiya Section">-2-</h3>
            <p class="Katiya">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Katiya">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Katiya">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Katiya">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Katiya">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Katiya">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Katiya">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <h3 class="Cody Section">-3-</h3>
            <p class="Cody">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Cody">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Cody">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Cody">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Cody">Lorem ipsum dolor sit amet consectetur adipiscing elit. Quisque faucibus ex sapien vitae pellentesque sem placerat. In id cursus mi pretium tellus duis convallis. Tempus leo eu aenean sed diam urna tempor. Pulvinar vivamus fringilla lacus nec metus bibendum egestas. Iaculis massa nisl malesuada lacinia integer nunc posuere. Ut hendrerit semper vel class aptent taciti sociosqu. Ad litora torquent per conubia nostra inceptos himenaeos.</p>
            <p class="Default"></p>
        </div>
    </div>
    <div class="ContainerFooter">Footer</div>
</div>

<script>

const ePAGE = document.getElementById('PAGE');
const eFULL = document.getElementById('FULL');
const eBODY = document.getElementById('BODY');

const jSTYLES = ` 
{
"Katiya":
  {
    "Light":[255,200,200,1],
    "Dark": [36 ,18 ,18 ,1]
  },
"Cody":
  {
    "Light":[200,200,255,1],
    "Dark": [18 ,18 ,36 ,1] 
  },
"Default":
  {
    "Light":[240,240,240,1],
    "Dark": [18 ,18 ,18 ,1] 
  }
}`
const STYLES = JSON.parse(jSTYLES.replaceAll(/(\r\n|\n|\r)/gm, ''));

var CHANNELbg = [];
var CHANNELtxt = [];

var DisplayMode = "Light";
var Position = 0;
var LastElement;
var NextElement;

function ScrollPosition() {
    let PageRect = ePAGE.getBoundingClientRect();
    let BodyRect = eBODY.getBoundingClientRect();

    let PageHeight = PageRect.height - BodyRect.height;
    let PositionHeight = PageRect.top - BodyRect.top;
    let ScrollPos = Math.abs(((PositionHeight/PageHeight)*100))
    ScrollPos = (ScrollPos>=98)?
                        100:
                        ((ScrollPos<=2)?
                            0:
                            ScrollPos);
    return ScrollPos;
}

function SetStyles() {
    let PageRect = ePAGE.getBoundingClientRect();
    let BodyRect = eBODY.getBoundingClientRect();

    let Elements = Object.values(document.getElementsByTagName('p'));
    //-console.log(Object.values(Elements));
    let ePosition = 0;
    let eName = Elements[0].className.split(" ")[0];
    ChannelPush(ePosition,eName,DisplayMode);
    Elements.forEach( elem => {
        ePosition = (((elem.getBoundingClientRect().top - PageRect.top) / PageRect.height)*100);
        eName = elem.className.split(" ")[0];
        console.log(eName)
        ChannelPush(ePosition,eName,DisplayMode);
    });
    ChannelPush(100,eName,DisplayMode);
}

function ChannelPush(position,name,mode) {
    let txtmode = (mode=="Light")?"Dark":"Light";
    CHANNELbg.push([
        position,
        STYLES[name][mode][0],
        STYLES[name][mode][1],
        STYLES[name][mode][2],
        STYLES[name][mode][3],
    ]);
    CHANNELtxt.push([
        position,
        STYLES[name][txtmode][0],
        STYLES[name][txtmode][1],
        STYLES[name][txtmode][2],
        STYLES[name][txtmode][3],
    ]);
}

function runScrollEvents() {
    Position = ScrollPosition();

    let BGstyle = ChannelSet(CHANNELbg);
    let TXTstyle = ChannelSet(CHANNELtxt);

    document.getElementsByTagName('body')[0].style.backgroundColor = `rgba(${BGstyle[0]},${BGstyle[1]},${BGstyle[2]},${BGstyle[3]})`;
    Object.values(document.getElementsByTagName('p')).forEach(pElem=>{
        pElem.style.color = `rgb(${TXTstyle[0]},${TXTstyle[1]},${TXTstyle[2]},${TXTstyle[3]})`;
    })
    Object.values(document.getElementsByTagName('h3')).forEach(pElem=>{
        pElem.style.color = `rgb(${TXTstyle[0]},${TXTstyle[1]},${TXTstyle[2]},${TXTstyle[3]})`;
    })
}

function ChannelSet(CHANNEL) {
    LastElement = CHANNEL[0];
    NextElement = CHANNEL[1];
    for (let i=0; i<CHANNEL.length-1; i++) {
        if (CHANNEL[i][0] < Position) {
            LastElement = Object.assign({}, CHANNEL[i]);
            NextElement = Object.assign({}, CHANNEL[i+1]);
        }
    }      
    let Progress = (NextElement[0]-Position)/(NextElement[0]-LastElement[0])
    console.debug(`
    Last Element: ${LastElement[0]},${LastElement[1]},${LastElement[2]},${LastElement[3]}\n
    Next Element: ${NextElement[0]},${NextElement[1]},${NextElement[2]},${NextElement[3]}\n
    Position: ${Position}\n
    Progress: ${Progress}
    `);

    let RED = (LastElement[1]*Progress)+(NextElement[1]*(1-Progress));
    let GRN = (LastElement[2]*Progress)+(NextElement[2]*(1-Progress));
    let BLU = (LastElement[3]*Progress)+(NextElement[3]*(1-Progress));
    let ALP = 1;

    return [RED,GRN,BLU,ALP];
}

SetStyles();
eBODY.addEventListener('scroll',runScrollEvents)
runScrollEvents();


</script>    
</body>
</html>